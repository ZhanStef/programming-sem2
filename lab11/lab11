#include <stdio.h>
#include <string.h>
#include <stdlib.h>

void input(FILE *);
void print(FILE *);
void add(FILE *);
void del_10kg(FILE *);

typedef struct passenger{
    char fam[20];
    char name[20];
    char otech[20];
    int c_bags; // count_bags
    int w_bags; // weight_bags
    char flag_del;
} pas;

pas t1;

int main(){
    char c;
    FILE *tf;
    while (1){
        puts("\n  1 – new passenger");
        puts("\n  2 – list of passengers");
        puts("\n  3 – add passenger");
        puts("\n  4 – delete passengers with luggage");
        puts("\n  0 - quit");

        c=getch();
        switch(c){
            case '1':input(tf);break;
            case '2':print(tf);break;
            case '3':app(tf);break;
            case '4':find(tf);break;
            case '0':return 0;
            default : puts(" wrong input ");
         }
    }
    return 0;
}
//from lection
void input(FILE *tf){
	char ch;
    tf=fopen("file1.dat","wb");
    printf("\n Passengers entry \n");
    do
    { printf("\n Family: ");
	  scanf("%s",&t1.fam);
      printf("\n Name: ");
      scanf("%s",&t1.name);
      printf("\n Otchestvo: ");
      scanf("%s",&t1.otech);
      printf("\n Amount of bags: ");
      scanf("%d",&t1.c_bags);
      printf("\n Total weight: ");
      scanf("%d",&t1.w_bags);
      fwrite(&t1,sizeof(pas),1,tf);
      printf("\n Finished?  y/n  ");
      ch=getch();
    }
    while (ch != 'y');
    fclose(tf);
}
void print(FILE *tf){
	int i;
	tf=fopen("file1.dat","rb");
    i=1;
    fread(&t1,sizeof(pas),1,tf);
    while (!feof(tf)){
		if(t1.flag_del!=0){
			printf("\n  %3d Family: %20s \nName: %20s \nOtchestvo: %20s \nAmount of bags: %2d \n Total weight: %4d",i,t1.fam,t1.name,t1.otech,t1.c_bags,t1.w_bags);
			i++;
		}
        fread(&t1,sizeof(pas),1,tf);
    }
    getch();
}
void add(FILE *tf){
	char ch;
	tf=fopen("file1.dat","ab"); //amend
	printf("\n Passengers entry \n");
	do{
	   	printf("\n Family: ");
		scanf("%s",&t1.fam);
		printf("\n Name: ");
		scanf("%s",&t1.name);
		printf("\n Otchestvo: ");
		scanf("%s",&t1.otech);
		printf("\n Amount of bags: ");
		scanf("%d",&t1.c_bags);
		printf("\n Total weight: ");
		scanf("%d",&t1.w_bags);
		fwrite(&t1,sizeof(pas),1,tf);
		printf("\n Finished?  y/n  ");
		ch=getch();
	}
  while (ch != 'y');
  fclose(tf);
}

void find(FILE *tf){
	char c,tov[10];
  tf=fopen("file1.dat","rb+");
  system(“CLS”);
  puts(" Название искомого товара: ");
  gets(tov);
  fread(&t1,sizeof(t1),1,tf);
  while (!feof(tf))
  {  if (strcmp(t1.name,tov)==0)
     {
        printf(" tovar %10s cena %6.2f kolic %d",t1.name,t1.c,t1.kol);
         getch();
      }
      fread(&t1,sizeof(t1),1,tf);
  }
  fclose(tf);
}
